var CMSPlugin={window:this.window,requires:["iframedialog","fakeobjects"],currentEditor:null,lang:["en"],regNumber:/^\d+(?:\.\d+)?$/,regFlashFilename:/\.swf(?:$|\?)/i,selection:null,selectedElement:null,selectionBookmarks:null,cssifyLength:function(a){return CMSPlugin.regNumber.test(a)?a+"px":a},createFakeControl:function(a,b){if(null!==a){var c=null,d=(c=a.attributes.type)?c.toLowerCase():"unknown",e;switch(d){case "youtubevideo":c=b.createFakeParserElement(a,"cke_youtube","object",!0);c.attributes.cms_youtube=
"true";c.attributes.cms_disable_media="true";break;case "flash":case "media":c="flash"===this.getMediaType(a,b)||"flash"===d?b.createFakeParserElement(a,"cke_flash","object",!0):b.createFakeParserElement(a,"cke_media","object",!0);c.attributes.cms_media="true";break;case "mediafilecontrol":c=b.createFakeParserElement(a,"cke_old_media","object",!0);c.attributes.cms_media="true";break;case "image":if(!(a.attributes.width&&0<parseInt(a.attributes.width,10)&&a.attributes.height&&0<parseInt(a.attributes.height,
10))&&(e=this.getElementObject(a)))if((!a.attributes.width||0>=parseInt(a.attributes.width,10))&&(!a.attributes.height||0>=parseInt(a.attributes.height,10)))a.attributes.width=e.originalwidth,a.attributes.height=e.originalheight;else if(!a.attributes.height||0>=parseInt(a.attributes.height,10))a.attributes.height=Math.round(a.attributes.width/(parseFloat(e.originalwidth)/e.originalheight));else if(!a.attributes.width||0>=parseInt(a.attributes.width,10))a.attributes.width=Math.round(a.attributes.height/
(parseFloat(e.originalheight)/e.originalwidth));c=b.createFakeParserElement(a,"cke_image","object",!0);c.attributes.cms_media="true";var f=this.getImageUrl(a,b);f&&(c.attributes.src=f);break;case "widget":e=this.getElementObject(a);c=b.createFakeParserElement(a,"cke_widget","object",!0);c.attributes.cms_disable_media="true";c.attributes.cke_widget="true";e.image_guid&&(f=c.attributes.style||"",c.attributes.style=f+"background-image:url("+b.config.ApplicationPath+"CMSPages/GetMetaFile.aspx?fileguid\x3d"+
e.image_guid+"\x26maxsidesize\x3d32);");e.widget_displayname&&(f=e.widget_displayname.replace(/\+/g," "),c.attributes.title=decodeURIComponent(f));break;default:c=b.createFakeParserElement(a,"cke_inlinecontrol","object",!1),c.attributes.cms_disable_media="true"}c.attributes.cms_inline="true";c.attributes.alt="";f=c.attributes.style||"";e=a.attributes.width;var g=a.attributes.height;"widget"!=d&&(c.attributes.title="","undefined"!=typeof e&&(f=c.attributes.style=f+"width:"+this.cssifyLength(e)+";"),
"undefined"!=typeof g&&(c.attributes.style=f+"height:"+this.cssifyLength(g)+";"));return c}return null},getNodeList:function(a){return new CKEDITOR.dom.nodeList(a)},getElementObject:function(a){var b={},c,d;if(a){var e;if(a._)for(e=0;e<a.children.length;e++)c=a.children[e].attributes.name,d=a.children[e].attributes.value,b[c]=d;else for(e=0;e<a.children.length;e++)c=a.children[e].getAttribute("name"),d=a.children[e].getAttribute("value"),b[c]=d}return b},getCurrentEditor:function(){return null!==
this.currentEditor?this.currentEditor:null!==CKEDITOR.currentInstance?CKEDITOR.currentInstance:null},getImageUrl:function(a,b){b=b||this.getCurrentEditor();var c=null,d=CMSPlugin.getElementObject(a);d.url&&(c=d.url,0===c.indexOf("~/")&&(c=c.replace("~/",b.config.ApplicationPath)));return c},getMediaType:function(a){var b=this.getElementObject(a);return b.cms_type?b.cms_type.toLowerCase():b.ext&&".swf"===b.ext.toLowerCase()||CMSPlugin.isFlashEmbed(a)?"flash":"audiovideo"},isFlashEmbed:function(a){a=
a.attributes;return"application/x-shockwave-flash"==a.type||"flash"==a.type||CMSPlugin.regFlashFilename.test(a.src||"")},initCss:function(a){CKEDITOR.addCss("img.cke_media { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/InsertImageOrMedia_bg.png")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #CCC;width: 80px;height: 80px;}");CKEDITOR.addCss("img.cke_flash { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/InsertFlash_bg.png")+
");background-position: center center;background-repeat: no-repeat;border: 1px solid #CCC;width: 80px;height: 80px;}");CKEDITOR.addCss("img.cke_old_media { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/InsertImageOrMediaOld_bg.png")+");background-position: center center;background-repeat: no-repeat;border: 1px solid #CCC;width: 80px;height: 80px;}")},openWidget:function(a,b,c,d,e){this.currentEditor=a;var f=a.getSelection().getSelectedElement();b=a.config.IsLiveSite?a.config.ApplicationPath+
"CMSModules/Widgets/LiveDialogs/"+b:a.config.ApplicationPath+"CMSModules/Widgets/Dialogs/"+b;f&&f.hasAttribute("cms_inline")&&(f=a.restoreRealElement(f),f=this.getInline(f.$),"widget"!==f.cms_type||null!==c&&c!==f.name||(d=a.config.CurrentAliasPath?a.config.CurrentAliasPath:"",b=a.config.ApplicationPath+(a.config.IsLiveSite?"CMSModules/Widgets/LiveDialogs/WidgetProperties.aspx":"CMSModules/Widgets/Dialogs/WidgetProperties.aspx"),b+="?inline\x3dtrue\x26aliaspath\x3d"+d,d=900,e=650));CMSPlugin.openModalDialog(b,
c,d,e)},pluginInsertMacro:function(a){var b="";a.config.ResolverName&&(b="resolver\x3d"+a.config.ResolverName);a.config.CurrentDocumentID&&(b&&(b+="\x26"),b+="documentid\x3d"+a.config.CurrentDocumentID);a.config.CurrentCulture&&(b&&(b+="\x26"),b+="culture\x3d"+a.config.CurrentCulture);a.ui.addButton("InsertMacro",{label:a.lang.CMSPlugins.InsertMacro.button,command:"InsertMacro",icon:a.config.CMSPluginUrl+"images/InsertMacro.png"});a.addCommand("InsertMacro",{exec:function(a){CMSPlugin.currentEditor=
a;CMSPlugin.openModalDialog(a.config.ApplicationPath+"CMSAdminControls/UI/Macros/Dialogs/Default.aspx?"+b,"insertMacro",1024,660)}})},pluginKeyPress:function(a){a.on("instanceReady",function(a){var c=function(a){if(!window.disableShortcuts){if(window.HtmlEditor)return window.HtmlEditor.keyPressed(a);if(null!==window.parent&&window.parent.HtmlEditor)return window.parent.HtmlEditor.keyPressed(a)}return!0},d=function(a){a=a.data;var b=a.$;a.key=a.getKey();a.ctrlKey=b.ctrlKey;a.altKey=b.altKey;a.shiftKey=
b.shiftKey;return a},e=function(a){a=d(a);a.ctrlKey&&a.altKey||c(a)},f=function(a){a=d(a);a.ctrlKey&&a.altKey&&c(a)};a.editor.document.on("keydown",e);a.editor.document.on("keyup",f);a.editor.on("mode",function(a){a=a.editor;"source"!==a.mode&&(a.document.on("keydown",e),a.document.on("keyup",f))})})},pluginInsertImageOrMedia:function(a){var b={label:a.lang.CMSPlugins.InsertImageOrMedia.button,command:"InsertImageOrMedia",icon:a.config.CMSPluginUrl+"images/InsertImageOrMedia.png"},c={imageormedia:{label:a.lang.CMSPlugins.InsertImageOrMedia.menu,
command:"InsertImageOrMedia",group:"InsertImageOrMedia",icon:a.config.CMSPluginUrl+"images/InsertImageOrMedia.png"}};a.addCommand("InsertImageOrMedia",{exec:function(a){var b=window.unescape(a.config.MediaDialogWidth),c=window.unescape(a.config.MediaDialogHeight);CMSPlugin.currentEditor=a;CMSPlugin.openModalDialog(a.config.MediaDialogURL,"imageormedia",b,c)}});a.ui.addButton("InsertImageOrMedia",b);a.on("doubleclick",function(a){var b=a.data.element;if(a.editor.config.removeButtons)for(var c in a.editor.config.removeButtons)if("InsertImageOrMedia"===
a.editor.config.removeButtons[c]){a.cancel();return}!b.is("img")||"true"!==b.getAttribute("cms_media")&&b.data("cke-realelement")||(a.editor.execCommand("InsertImageOrMedia"),a.cancel())},null,null,1);a.addMenuItems&&(a.addMenuGroup("InsertImageOrMedia"),a.addMenuItems(c));a.contextMenu&&a.contextMenu.addListener(function(a){if(a&&a.is("img")&&"cke_anchor"!=a.getAttribute("class")&&"flash"!=a.data("cke-real-element-type")&&("true"==a.getAttribute("cms_media")||"true"!=a.getAttribute("cms_disable_media")))return{imageormedia:CKEDITOR.TRISTATE_OFF}});
a.on("toHtml",function(a){function b(a){a.children&&a.children.forEach(b);if("img"==a.name&&"undefined"!==typeof a.attributes.src&&-1===a.attributes.src.indexOf("data:image")){var c=a.attributes.src;-1==c.indexOf("?")&&(c+="?");c+="\x26"+g;a.attributes.src=c}}var c=a.data.dataValue,g=a.editor.config.AppendToImagePath;"undefined"!==typeof g&&0<g.length&&b(c)})},pluginInsertLink:function(a){var b={label:a.lang.CMSPlugins.InsertLink.button,command:"InsertLink",icon:a.config.CMSPluginUrl+"images/InsertLink.png"},
c={insertLink:{label:a.lang.CMSPlugins.InsertLink.menu,command:"InsertLink",group:"InsertLink",icon:a.config.CMSPluginUrl+"images/InsertLink.png"}};a.addCommand("InsertLink",{exec:function(a){var b=window.unescape(a.config.LinkDialogWidth),c=window.unescape(a.config.LinkDialogHeight);CMSPlugin.currentEditor=a;CMSPlugin.openModalDialog(a.config.LinkDialogURL,"imageormedia",b,c)}},1);a.ui.addButton("InsertLink",b);a.on("doubleclick",function(b){var c;try{c=CKEDITOR.plugins.link.getSelectedLink(a)||
b.data.element}catch(f){}if(b.editor.config.removeButtons)for(var g in b.editor.config.removeButtons)if("InsertLink"===b.editor.config.removeButtons[g]){b.cancel();return}c&&(c.isReadOnly()||"Disabled"==b.editor.config.toolbar?b.stop():c.is("a")?c.getAttribute("name")&&!c.getAttribute("href")?b.data.dialog="anchor":(b.editor.execCommand("InsertLink"),b.cancel()):c.is("img")&&"anchor"==c.data("cke-real-element-type")&&(b.data.dialog="anchor"))},null,null,1);a.addMenuItems&&(a.addMenuGroup("InsertLink"),
a.addMenuItems(c));a.contextMenu&&a.contextMenu.addListener(function(b){if(!b||b.isReadOnly())return null;b=b.is("img")&&"anchor"==b.data("cke-real-element-type");if(!b){if(!(b=CKEDITOR.plugins.link.getSelectedLink(a)))return null;b=b.getAttribute("name")&&!b.getAttribute("href")}if(!b)return{insertLink:CKEDITOR.TRISTATE_OFF}})},pluginQuicklyInsertMedia:function(a){a.addCommand("QuicklyInsertImage",{exec:function(a){CMSPlugin.currentEditor=a;CMSPlugin.saveFocus(a)}});a.ui.addButton("QuicklyInsertImage",
{label:a.lang.CMSPlugins.QuicklyInsertImage.button,icon:a.config.CMSPluginUrl+"images/QuicklyInsertImage.png",onRender:function(){a.config.qimId||(a.config.qimId=[]);a.config.qimId.push(this._.id);a.on("instanceReady",function(){function b(a){if(a){var b=a.match(/(?:formGuid=)([a-z\d-]+)/i),c=a.match(/(?:documentid=)([\d]+)/i);a=a.match(/(?:parentid=)([\d]+)/i);if(b&&a&&/^[a-f\d]{8}-[a-f\d]{4}-[a-f\d]{4}-[a-f\d]{4}-[a-f\d]{12}$/i.test(b[1])&&0<=parseInt(a[1],10)||c&&0<=parseInt(c[1],10))return!0}return!1}
window.InsertImageOrMedia=function(a,b,c,d,e){CMSPlugin.insert(e)};for(g=0;g<a.config.qimId.length;g++){var c=a.config.qimId[g],d=document.getElementById(c);if(null!==d&&!d.QIM_set)if(d.QIM_set=!0,b(this.config.QuickInsertURL)&&!window.disableQim){d.className+=" CMS_QIM";$cmsj(d).mouseenter(function(){CMSPlugin.currentEditor=a;CMSPlugin.saveFocus(a)});d.onmousemove=function(){CMSPlugin.currentEditor=a};for(var e=d.getElementsByTagName("span"),f,g=0;g<e.length;g++)-1<e[g].className.indexOf("cke_button_icon")&&
(f=e[g]);"undefined"!==typeof f&&(f.style.position="relative",f.style.background="",e=document.createElement("div"),e.className="InnerDiv",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.display="inline-block",e.innerHTML='\x3cimg src\x3d"'+a.config.CMSPluginUrl+'images/QuicklyInsertImage.png" style\x3d"width:16px; height:16px;" /\x3e',f.appendChild(e),e=document.createElement("div"),e.className="UploaderDiv",e.style.position="absolute",e.style.top="0px",e.style.width="16px",
e.style.height="16px",e.style.visibility="visible",e.style.opacity="1",e.innerHTML='\x3ciframe name\x3d"QuickInsertImage" src\x3d"'+a.config.QuickInsertURL+"\x26containerid\x3d"+c+'" frameborder\x3d"0" marginWidth\x3d"0" marginHeight\x3d"0" scrolling\x3d"no" border\x3d"0" style\x3d"width:16px; height:16px; overflow:hidden;" allowtransparency\x3d"true" \x3e\x3c/iframe\x3e',f.appendChild(e),c=document.createElement("div"),c.className="LoadingDiv",c.style.position="absolute",c.style.opacity="1",c.style.display=
"none",c.style.top="0px",c.style.left="0px",c.innerHTML='\x3cimg src\x3d"'+a.config.ApplicationPath+'CMSPages/GetResource.ashx?image\x3dDesign/Preloaders/preload16.gif" style\x3d"width:16px; height:16px;" /\x3e',f.appendChild(c),c=document.createElement("script"),c.type="text/javascript",c.src=a.config.ApplicationPath+"CMSModules/Content/Controls/Attachments/DirectFileUploader/DirectFileUploader.js",d.appendChild(c))}else d.parentNode.removeChild(d)}})}});a.on("mode",function(){if(a.config.qimId)for(var b=
0;b<a.config.qimId.length;b++){var c=document.getElementById(a.config.qimId[b]);if(c){var d=c.getElementsByTagName("iframe");"source"==a.mode?(c.className+=" cke_button_disabled",d&&1===d.length&&(d[0].style.display="none")):(c.className=c.className.replace(/\s+cke_button_disabled/ig,""),d&&1===d.length&&(d[0].style.display=""))}}})},pluginForumButtons:function(a){var b={label:a.lang.CMSPlugins.InsertImage.button,command:"InsertImage",icon:a.config.CMSPluginUrl+"images/InsertImage.png"},c={label:a.lang.CMSPlugins.InsertUrl.button,
command:"InsertUrl",icon:a.config.CMSPluginUrl+"images/InsertUrl.png"};a.ui.addButton("InsertQuote",{label:a.lang.CMSPlugins.InsertQuote.button,command:"InsertQuote",icon:a.config.CMSPluginUrl+"images/InsertQuote.png"});a.addCommand("InsertQuote",{exec:function(a){a.insertHtml("[quote\x3d][/quote]")}});a.ui.addButton("InsertImage",b);a.addCommand("InsertImage",{exec:function(a){var b=prompt(a.lang.CMSPlugins.InsertImage.prompturl,"http://");b&&a.insertHtml("[img]"+b+"[/img]")}});a.ui.addButton("InsertUrl",
c);a.addCommand("InsertUrl",{exec:function(a){var b=prompt(a.lang.CMSPlugins.InsertUrl.prompturl,"http://");if(b){var c=prompt(a.lang.CMSPlugins.InsertUrl.promptdesc,"");a.insertHtml("[url\x3d"+b+"]"+c+"[/url]")}}})},initMaximalization:function(a){a.on("maximize",function(b){b=b.data;if(a.config.sharedSpaces&&b==CKEDITOR.TRISTATE_ON){-1<(new CKEDITOR.dom.element(document.body)).getCustomData("maximize_saved_styles")["class"].indexOf("cms-bootstrap")&&(document.body.className+=" cms-bootstrap");b=
$cmsj("#"+a.config.sharedSpaces.top);var c=b.offset().top+b.outerHeight();a.container.getChild(1).setStyle("top",c+"px");b=CKEDITOR.document.getWindow().getViewPaneSize();var d=$cmsj("#"+a.config.sharedSpaces.bottom),c=b.height-c-d.outerHeight();a.resize(b.width,c,null,!0)}})},initPopupOpener:function(a){a.popup=function(a,c,d,e){CMSPlugin.openModalDialog(a,"CKEditorPopup",c,d,e)}},initContextMenu:function(a){var b={Image:"image",Link:"link",Unlink:"unlink",Flash:"flash",Table:"table"},c=a.config.toolbar instanceof
Array?a.config.toolbar:a.config["toolbar_"+a.config.toolbar];if("undefined"!==typeof c){for(var d=0;d<c.length;d++){var e=c[d];if(e)for(var f=0;f<e.length;f++){var g=e[f];b[g]&&delete b[g]}}for(var h in b)delete a._.menuItems[b[h]]}},initSelection:function(a){a.on("beforeCommandExec",function(a){CMSPlugin.saveFocus(a.editor)})},initDataProcesor:function(a){var b=a.dataProcessor;(b=b&&b.dataFilter)&&b.addRules({elements:{"cke:object":function(b){if(!b.attributes.codetype||"cmsinlinecontrol"!=b.attributes.codetype.toLowerCase()){var d=
b.attributes;if(!(d.classid&&String(d.classid).toLowerCase()||CMSPlugin.isFlashEmbed(b))){for(d=0;d<b.children.length;d++)if("cke:embed"==b.children[d].name){if(!CMSPlugin.isFlashEmbed(b.children[d]))break;b.attributes.type="flash";return CMSPlugin.createFakeControl(b,a)}return null}b.attributes.type="flash"}return CMSPlugin.createFakeControl(b,a)},"cke:embed":function(b){var d=null;CMSPlugin.isFlashEmbed(b)&&(b.attributes.type="flash",d=CMSPlugin.createFakeControl(b,a));return d}}},3)},getInline:function(a,
b){var c={};if(a){var d=a.getAttribute("type"),e=a.getAttribute("width"),f=a.getAttribute("height");d&&("media"==d.toLowerCase()&&(d=this.getMediaType(a)),c.cms_type=d);if(a.childNodes){var g=this.getPropertyPrefix(d);e&&(c[g+"width"]=e);f&&(c[g+"height"]=f);d=a.childNodes.length;for(e=0;e<d;e++){var h=a.childNodes[e],f=h.getAttribute("name"),h=h.getAttribute("value");f&&(c[g+f]=h,"flash_movie"===g+f&&(c.flash_url=h))}}try{if(a=CKEDITOR.dom.element.get(b)){var l=a.getAscendant("a",!0);l&&(c[g+"link"]=
l.getAttribute("data-cke-saved-href")||l.getAttribute("href"),c[g+"target"]=l.getAttribute("target"))}}catch(n){}}return c},getPropertyPrefix:function(a){var b="";switch(a.toLowerCase()){case "youtubevideo":b="youtube_";break;case "image":b="img_";break;case "audiovideo":b="av_";break;case "flash":b="flash_"}return b},getInlineType:function(a){var b="";switch(a.toLowerCase()){case "youtubevideo":b="YouTubeVideo";break;case "image":b="Image";break;case "audiovideo":case "flash":b="Media";break;case "widget":b=
"Widget"}return b},createCKElement:function(a){var b=this.getCurrentEditor();return b?b.document.createElement(a):null},insertInline:function(a,b){if(a){var c=this.getInlineType(a),d=this.getPropertyPrefix(a),e=this.getCurrentEditor(),c='\x3cobject style\x3d"display: none" codetype\x3d"CMSInlineControl" type\x3d"'+c+'" ',f={img_link:1,img_target:1},g={img_hspace:-1,img_vspace:-1,img_borderwidth:-1,flash_loop:"False",flash_autoplay:"False",flash_menu:"False",av_autoplay:"False",av_loop:"False",av_controls:"True"};
b[d+"width"]&&(c+='width\x3d"'+b[d+"width"]+'" ',b[d+"width"]=null);b[d+"height"]&&(c+='height\x3d"'+b[d+"height"]+'" ',b[d+"height"]=null);var c=c+"\x3e",h;for(h in b)!f[h]&&b[h]&&b[h]!=g[h]&&(c+='\x3cparam name\x3d"'+h.replace(d,"")+'" value\x3d"'+b[h]+'" /\x3e');c+="\x3c/object\x3e";if(b.img_link){var l;try{CMSPlugin.restoreFocus(e);var n=e.getSelection();if(n.getType()==CKEDITOR.SELECTION_ELEMENT){var m=n.getSelectedElement();m.is("a")&&(l=m)}var k=n.getRanges(!0)[0];k.shrink(CKEDITOR.SHRINK_TEXT);
l=k.getCommonAncestor().getAscendant("a",!0)}catch(p){}l?(d={href:"javascript:void(0)/*"+CKEDITOR.tools.getNextNumber()+"*/"},e=[],d["data-cke-saved-href"]=b.img_link,b.img_target?d.target=b.img_target:e.push("target"),l.setAttributes(d),l.removeAttributes(e),l.setHtml(c),c=l.getOuterHtml()):(l='\x3ca href\x3d"'+b.img_link+'" ',b.img_target&&(l+='target\x3d"'+b.img_target+'" '),c=l+"\x3e"+c+"\x3c/a\x3e")}else e.document.$.execCommand("unlink",!1,null);this.insertHtml(c)}},insertLink:function(a){var b=
{href:"javascript:void(0)/*"+CKEDITOR.tools.getNextNumber()+"*/"},c=[],d=this.getCurrentEditor(),e=null,f=null,g=null,h=null;try{CMSPlugin.restoreFocus(d);m=d.getSelection();if(m.getType()==CKEDITOR.SELECTION_ELEMENT){var l=m.getSelectedElement();l.is("a")&&(e=l)}k=m.getRanges(!0)[0];k.shrink(CKEDITOR.SHRINK_TEXT);e=k.getCommonAncestor().getAscendant("a",!0)}catch(n){}a.link_url?(k=a.link_protocol||"",m=a.link_url||"",b["data-cke-saved-href"]=0===m.indexOf("/")?m:k+m):a.anchor_name?(f=a.anchor_name||
"",g=a.anchor_custom||"",h=a.anchor_id||"",b["data-cke-saved-href"]="#"+(f||g||h||"")):a.email_to&&(k=a.email_cc,m=a.email_bcc,f=a.email_subject,g=a.email_body,h=[],k&&h.push("cc\x3d"+k),m&&h.push("bcc\x3d"+m),f&&h.push("subject\x3d"+f),g&&h.push("body\x3d"+g),h=h.length?"?"+h.join("\x26"):"",b["data-cke-saved-href"]="mailto:"+a.email_to+h);a.link_target?b.target=a.link_target:c.push("target");a.link_url&&(k=function(a,d,e){(a=a[d])?b[e]=a:c.push(e)},k(a,"link_url","href"),k(a,"link_id","id"),k(a,
"link_target","target"),k(a,"link_class","class"),k(a,"link_tooltip","title"),k(a,"link_style","style"),a.link_name?(b.name=b["data-cke-saved-name"]=a.link_name,b["class"]=(b["class"]?b["class"]+" ":"")+"cke_anchor"):c=c.concat(["data-cke-saved-name","name"]));if(e)a=e,a.setAttributes(b),a.removeAttributes(c),a.getAttribute("name")?a.addClass("cke_anchor"):a.removeClass("cke_anchor"),this.fakeObj&&d.createFakeElement(a,"cke_anchor","anchor").replace(this.fakeObj),delete e;else{var m=d.getSelection(),
e=m.getRanges(!0),k=e[0];1==e.length&&k.collapsed&&(f=new CKEDITOR.dom.text(a.email_linktext?a.email_linktext:a.email_to?a.email_to:a.anchor_linktext?a.anchor_linktext:a.anchor_name?a.anchor_name:a.link_text?a.link_text:a.link_url,d.document),e[0].insertNode(f),e[0].selectNodeContents(f),m.selectRanges(e));e=new CKEDITOR.style({element:"a",attributes:b});e.type=CKEDITOR.STYLE_INLINE;e.applyToRange(k);if(a.link_id)for(d=d.document.$.getElementsByTagName("a"),e=0;e<d.length;e++)if(d[e].getAttribute("href")==
b.href){d[e].id=a.link_id;break}}},insertImage:function(a){var b=this.createCKElement("img");if(null!=b){a.img_id&&(b.$.id=a.img_id);a.img_url&&(b.$.src=a.img_url,b.$.setAttribute("data-cke-saved-src",a.img_url));b.$.alt=a.img_alt?a.img_alt:a.img_tooltip?a.img_tooltip:"";a.img_tooltip&&(b.$.title=a.img_tooltip);a.img_class&&b.$.setAttribute("class",a.img_class);a.img_dir&&(b.$.dir=a.img_dir);a.img_usemap&&(b.$.useMap=a.img_usemap);a.img_longdescription&&b.$.setAttribute("longdesc",a.img_longdescription);
a.img_lang&&(b.$.lang=a.img_lang);a.img_style&&(b.setAttribute("style",a.img_style),void 0!=b.$.style.cssStyle&&(b.$.style.cssStyle=a.img_style),void 0!=b.$.style.cssText&&(b.$.style.cssText=a.img_style));a.img_width&&0<=parseInt(a.img_width,10)&&(b.$.style.width=parseInt(a.img_width,10)+"px");a.img_height&&0<=parseInt(a.img_height,10)&&(b.$.style.height=parseInt(a.img_height,10)+"px");a.img_borderwidth&&0<=parseInt(a.img_borderwidth,10)&&(b.$.style.borderWidth=a.img_borderwidth+"px",b.$.style.borderStyle=
"solid");if(a.img_bordercolor)try{b.$.style.borderColor=a.img_bordercolor}catch(c){b.$.style.borderColor=""}a.img_align&&("left"==a.img_align||"right"==a.img_align?(void 0!=b.$.style.cssFloat&&(b.$.style.cssFloat=a.img_align),void 0!=b.$.style.styleFloat&&(b.$.style.styleFloat=a.img_align)):(void 0!=b.$.style.verticalAlign&&(b.$.style.verticalAlign=a.img_align),void 0!=b.$.style["vartical-align"]&&(b.$.style["vartical-align"]=a.img_align)));if(a.img_vspace||a.img_hspace){var d=parseInt(a.img_vspace,
10),e=parseInt(a.img_hspace,10);if(d==e&&0<=d)b.$.style.margin=e+"px";else if(d!=e||-1!=d)b.$.style.margin=(0<=d?d+"px ":"auto ")+(0<=e?e+"px":"auto")}a.img_link||a.img_behavior?(d=this.createCKElement("a"),a.img_link&&(d.$.href=a.img_link,d.$.setAttribute("data-cke-saved-href",a.img_link)),a.img_target?d.$.setAttribute("target",a.img_target):a.img_behavior&&d.$.setAttribute("target",a.img_behavior),d.append(b),this.insertElement(d)):this.insertElement(b)}},insertHtml:function(a){var b=this.getCurrentEditor();
b&&(CMSPlugin.restoreFocus(b),b.insertHtml(a))},insertElement:function(a){var b=this.getCurrentEditor();b&&(CMSPlugin.restoreFocus(b),b.insertElement(a))},insert:function(a){if(a){var b=a.cms_type;b?this.insertInline(b,a):a.link_url||a.email_to||a.anchor_name?this.insertLink(a):a.img_url&&this.insertImage(a)}},saveFocus:function(a){CMSPlugin.selection=a.getSelection();CMSPlugin.selection?(CMSPlugin.selectedElement=CMSPlugin.selection.getSelectedElement(),CMSPlugin.selectionBookmarks=CMSPlugin.selection.createBookmarks2()):
(CMSPlugin.selectedElement=null,CMSPlugin.selectionBookmarks=null)},restoreFocus:function(a){CMSPlugin.selection?CMSPlugin.selectionBookmarks?CMSPlugin.selection.selectBookmarks(CMSPlugin.selectionBookmarks):CMSPlugin.selectedElement?CMSPlugin.selection.selectElement(CMSPlugin.selectedElement):a.focus():a.focus()},openModalDialog:function(a,b,c,d,e){window.modalDialog(a,b,c,d,e)},beforeInit:function(a){this.pluginKeyPress(a)},init:function(a){this.initCss(a);this.initMaximalization(a);this.initSelection(a);
this.pluginInsertMacro(a);this.pluginInsertImageOrMedia(a);this.pluginInsertLink(a);this.pluginQuicklyInsertMedia(a);this.pluginForumButtons(a)},afterInit:function(a){this.initContextMenu(a);this.initDataProcesor(a);this.initPopupOpener(a)}};CKEDITOR.plugins.add("CMSPlugins",CMSPlugin);